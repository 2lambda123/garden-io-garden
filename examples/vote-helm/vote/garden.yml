kind: Deploy
description: Helm chart for the voting UI
type: helm
name: vote
dependencies:
  - deploy.api
spec:
  sync:
    paths:
      - target: /app/src
        source: src
        mode: two-way
  values:
    image:
      repository: ${action.build.vote-image.outputs.deployment-image-name}
      tag: ${action.build.vote-image.version}
    ingress:
      enabled: true
      paths: [/]
      hosts: ["vote.${var.baseHostname}"]
    env:
      - name: HOSTNAME
        value: vote.${var.baseHostname}

---
kind: Test
name: vote-integ
type: container
build: vote-image
dependencies:
  - deploy.vote
timeout: 60
spec:
  args: [npm, run, test:integ]
