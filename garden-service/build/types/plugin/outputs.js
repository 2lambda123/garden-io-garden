"use strict";
/*
 * Copyright (C) 2018 Garden Technologies, Inc. <info@garden.io>
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const Joi = require("joi");
const base_1 = require("../../vcs/base");
const module_1 = require("../../config/module");
exports.environmentStatusSchema = Joi.object()
    .keys({
    ready: Joi.boolean()
        .required()
        .description("Set to true if the environment is fully configured for a provider."),
    needUserInput: Joi.boolean()
        .description("Set to true if the environment needs user input to be initialized, " +
        "and thus needs to be initialized via `garden init`."),
    detail: Joi.object()
        .meta({ extendable: true })
        .description("Use this to include additional information that is specific to the provider."),
})
    .description("Description of an environment's status for a provider.");
exports.prepareEnvironmentResultSchema = Joi.object().keys({});
exports.cleanupEnvironmentResultSchema = Joi.object().keys({});
exports.getSecretResultSchema = Joi.object()
    .keys({
    value: Joi.string()
        .allow(null)
        .required()
        .description("The config value found for the specified key (as string), or null if not found."),
});
exports.setSecretResultSchema = Joi.object().keys({});
exports.deleteSecretResultSchema = Joi.object()
    .keys({
    found: Joi.boolean()
        .required()
        .description("Set to true if the key was deleted, false if it was not found."),
});
exports.execInServiceResultSchema = Joi.object()
    .keys({
    code: Joi.number()
        .required()
        .description("The exit code of the command executed in the service container."),
    output: Joi.string()
        .required()
        .description("The output of the executed command."),
    stdout: Joi.string()
        .description("The stdout output of the executed command (if available)."),
    stderr: Joi.string()
        .description("The stderr output of the executed command (if available)."),
});
exports.serviceLogEntrySchema = Joi.object()
    .keys({
    serviceName: Joi.string()
        .required()
        .description("The name of the service the log entry originated from."),
    timestamp: Joi.date()
        .required()
        .description("The time when the log entry was generated by the service."),
    msg: Joi.string()
        .required()
        .description("The content of the log entry."),
})
    .description("A log entry returned by a getServiceLogs action handler.");
exports.getServiceLogsResultSchema = Joi.object().keys({});
exports.moduleTypeDescriptionSchema = Joi.object()
    .keys({
    docs: Joi.string()
        .required()
        .description("Documentation for the module type, in markdown format."),
    schema: Joi.object()
        .required()
        .description("A valid OpenAPI schema describing the configuration keys for the `module` field in the module's `garden.yml`."),
});
exports.validateModuleResultSchema = module_1.moduleConfigSchema;
exports.buildModuleResultSchema = Joi.object()
    .keys({
    buildLog: Joi.string()
        .allow("")
        .description("The full log from the build."),
    fetched: Joi.boolean()
        .description("Set to true if the build was fetched from a remote registry."),
    fresh: Joi.boolean()
        .description("Set to true if the build was perfomed, false if it was already built, or fetched from a registry"),
    version: Joi.string()
        .description("The version that was built."),
    details: Joi.object()
        .description("Additional information, specific to the provider."),
});
exports.pushModuleResultSchema = Joi.object()
    .keys({
    pushed: Joi.boolean()
        .required()
        .description("Set to true if the module was pushed."),
    message: Joi.string()
        .description("Optional result message."),
});
exports.publishModuleResultSchema = Joi.object()
    .keys({
    published: Joi.boolean()
        .required()
        .description("Set to true if the module was published."),
    message: Joi.string()
        .description("Optional result message."),
});
exports.runResultSchema = Joi.object()
    .keys({
    moduleName: Joi.string()
        .description("The name of the module that was run."),
    command: Joi.array().items(Joi.string())
        .required()
        .description("The command that was run in the module."),
    version: base_1.moduleVersionSchema,
    success: Joi.boolean()
        .required()
        .description("Whether the module was successfully run."),
    startedAt: Joi.date()
        .required()
        .description("When the module run was started."),
    completedAt: Joi.date()
        .required()
        .description("When the module run was completed."),
    output: Joi.string()
        .required()
        .allow("")
        .description("The output log from the run."),
});
exports.testResultSchema = exports.runResultSchema
    .keys({
    testName: Joi.string()
        .required()
        .description("The name of the test that was run."),
});
exports.getTestResultSchema = exports.testResultSchema.allow(null);
exports.buildStatusSchema = Joi.object()
    .keys({
    ready: Joi.boolean()
        .required()
        .description("Whether an up-to-date build is ready for the module."),
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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RUFBRSxHQUFHLENBQUMsTUFBTSxFQUFFO1NBQ25CLFFBQVEsRUFBRTtTQUNWLFdBQVcsQ0FBQyxvQ0FBb0MsQ0FBQztDQUNyRCxDQUFDLENBQUE7QUFFUyxRQUFBLG1CQUFtQixHQUFHLHdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtBQU1sRCxRQUFBLGlCQUFpQixHQUFHLEdBQUcsQ0FBQyxNQUFNLEVBQUU7S0FDMUMsSUFBSSxDQUFDO0lBQ0osS0FBSyxFQUFFLEdBQUcsQ0FBQyxPQUFPLEVBQUU7U0FDakIsUUFBUSxFQUFFO1NBQ1YsV0FBVyxDQUFDLHNEQUFzRCxDQUFDO0NBQ3ZFLENBQUMsQ0FBQSIsImZpbGUiOiJ0eXBlcy9wbHVnaW4vb3V0cHV0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTggR2FyZGVuIFRlY2hub2xvZ2llcywgSW5jLiA8aW5mb0BnYXJkZW4uaW8+XG4gKlxuICogVGhpcyBTb3VyY2UgQ29kZSBGb3JtIGlzIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNb3ppbGxhIFB1YmxpY1xuICogTGljZW5zZSwgdi4gMi4wLiBJZiBhIGNvcHkgb2YgdGhlIE1QTCB3YXMgbm90IGRpc3RyaWJ1dGVkIHdpdGggdGhpc1xuICogZmlsZSwgWW91IGNhbiBvYnRhaW4gb25lIGF0IGh0dHA6Ly9tb3ppbGxhLm9yZy9NUEwvMi4wLy5cbiAqL1xuXG5pbXBvcnQgKiBhcyBKb2kgZnJvbSBcImpvaVwiXG5pbXBvcnQgeyBNb2R1bGVWZXJzaW9uLCBtb2R1bGVWZXJzaW9uU2NoZW1hIH0gZnJvbSBcIi4uLy4uL3Zjcy9iYXNlXCJcbmltcG9ydCB7IFByaW1pdGl2ZU1hcCB9IGZyb20gXCIuLi8uLi9jb25maWcvY29tbW9uXCJcbmltcG9ydCB7IE1vZHVsZSB9IGZyb20gXCIuLi9tb2R1bGVcIlxuaW1wb3J0IHsgU2VydmljZVN0YXR1cyB9IGZyb20gXCIuLi9zZXJ2aWNlXCJcbmltcG9ydCB7IG1vZHVsZUNvbmZpZ1NjaGVtYSwgTW9kdWxlQ29uZmlnIH0gZnJvbSBcIi4uLy4uL2NvbmZpZy9tb2R1bGVcIlxuXG5leHBvcnQgaW50ZXJmYWNlIEVudmlyb25tZW50U3RhdHVzIHtcbiAgcmVhZHk6IGJvb2xlYW5cbiAgbmVlZFVzZXJJbnB1dD86IGJvb2xlYW5cbiAgZGV0YWlsPzogYW55XG59XG5cbmV4cG9ydCBjb25zdCBlbnZpcm9ubWVudFN0YXR1c1NjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgcmVhZHk6IEpvaS5ib29sZWFuKClcbiAgICAgIC5yZXF1aXJlZCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJTZXQgdG8gdHJ1ZSBpZiB0aGUgZW52aXJvbm1lbnQgaXMgZnVsbHkgY29uZmlndXJlZCBmb3IgYSBwcm92aWRlci5cIiksXG4gICAgbmVlZFVzZXJJbnB1dDogSm9pLmJvb2xlYW4oKVxuICAgICAgLmRlc2NyaXB0aW9uKFxuICAgICAgICBcIlNldCB0byB0cnVlIGlmIHRoZSBlbnZpcm9ubWVudCBuZWVkcyB1c2VyIGlucHV0IHRvIGJlIGluaXRpYWxpemVkLCBcIiArXG4gICAgICAgIFwiYW5kIHRodXMgbmVlZHMgdG8gYmUgaW5pdGlhbGl6ZWQgdmlhIGBnYXJkZW4gaW5pdGAuXCIsXG4gICAgICApLFxuICAgIGRldGFpbDogSm9pLm9iamVjdCgpXG4gICAgICAubWV0YSh7IGV4dGVuZGFibGU6IHRydWUgfSlcbiAgICAgIC5kZXNjcmlwdGlvbihcIlVzZSB0aGlzIHRvIGluY2x1ZGUgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiB0aGF0IGlzIHNwZWNpZmljIHRvIHRoZSBwcm92aWRlci5cIiksXG4gIH0pXG4gIC5kZXNjcmlwdGlvbihcIkRlc2NyaXB0aW9uIG9mIGFuIGVudmlyb25tZW50J3Mgc3RhdHVzIGZvciBhIHByb3ZpZGVyLlwiKVxuXG5leHBvcnQgdHlwZSBFbnZpcm9ubWVudFN0YXR1c01hcCA9IHtcbiAgW2tleTogc3RyaW5nXTogRW52aXJvbm1lbnRTdGF0dXMsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJlcGFyZUVudmlyb25tZW50UmVzdWx0IHsgfVxuXG5leHBvcnQgY29uc3QgcHJlcGFyZUVudmlyb25tZW50UmVzdWx0U2NoZW1hID0gSm9pLm9iamVjdCgpLmtleXMoe30pXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xlYW51cEVudmlyb25tZW50UmVzdWx0IHsgfVxuXG5leHBvcnQgY29uc3QgY2xlYW51cEVudmlyb25tZW50UmVzdWx0U2NoZW1hID0gSm9pLm9iamVjdCgpLmtleXMoe30pXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0U2VjcmV0UmVzdWx0IHtcbiAgdmFsdWU6IHN0cmluZyB8IG51bGxcbn1cblxuZXhwb3J0IGNvbnN0IGdldFNlY3JldFJlc3VsdFNjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgdmFsdWU6IEpvaS5zdHJpbmcoKVxuICAgICAgLmFsbG93KG51bGwpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIGNvbmZpZyB2YWx1ZSBmb3VuZCBmb3IgdGhlIHNwZWNpZmllZCBrZXkgKGFzIHN0cmluZyksIG9yIG51bGwgaWYgbm90IGZvdW5kLlwiKSxcbiAgfSlcblxuZXhwb3J0IGludGVyZmFjZSBTZXRTZWNyZXRSZXN1bHQgeyB9XG5cbmV4cG9ydCBjb25zdCBzZXRTZWNyZXRSZXN1bHRTY2hlbWEgPSBKb2kub2JqZWN0KCkua2V5cyh7fSlcblxuZXhwb3J0IGludGVyZmFjZSBEZWxldGVTZWNyZXRSZXN1bHQge1xuICBmb3VuZDogYm9vbGVhblxufVxuXG5leHBvcnQgY29uc3QgZGVsZXRlU2VjcmV0UmVzdWx0U2NoZW1hID0gSm9pLm9iamVjdCgpXG4gIC5rZXlzKHtcbiAgICBmb3VuZDogSm9pLmJvb2xlYW4oKVxuICAgICAgLnJlcXVpcmVkKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIlNldCB0byB0cnVlIGlmIHRoZSBrZXkgd2FzIGRlbGV0ZWQsIGZhbHNlIGlmIGl0IHdhcyBub3QgZm91bmQuXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4ZWNJblNlcnZpY2VSZXN1bHQge1xuICBjb2RlOiBudW1iZXJcbiAgb3V0cHV0OiBzdHJpbmdcbiAgc3Rkb3V0Pzogc3RyaW5nXG4gIHN0ZGVycj86IHN0cmluZ1xufVxuXG5leHBvcnQgY29uc3QgZXhlY0luU2VydmljZVJlc3VsdFNjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgY29kZTogSm9pLm51bWJlcigpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIGV4aXQgY29kZSBvZiB0aGUgY29tbWFuZCBleGVjdXRlZCBpbiB0aGUgc2VydmljZSBjb250YWluZXIuXCIpLFxuICAgIG91dHB1dDogSm9pLnN0cmluZygpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIG91dHB1dCBvZiB0aGUgZXhlY3V0ZWQgY29tbWFuZC5cIiksXG4gICAgc3Rkb3V0OiBKb2kuc3RyaW5nKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIlRoZSBzdGRvdXQgb3V0cHV0IG9mIHRoZSBleGVjdXRlZCBjb21tYW5kIChpZiBhdmFpbGFibGUpLlwiKSxcbiAgICBzdGRlcnI6IEpvaS5zdHJpbmcoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIHN0ZGVyciBvdXRwdXQgb2YgdGhlIGV4ZWN1dGVkIGNvbW1hbmQgKGlmIGF2YWlsYWJsZSkuXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcnZpY2VMb2dFbnRyeSB7XG4gIHNlcnZpY2VOYW1lOiBzdHJpbmdcbiAgdGltZXN0YW1wOiBEYXRlXG4gIG1zZzogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBzZXJ2aWNlTG9nRW50cnlTY2hlbWEgPSBKb2kub2JqZWN0KClcbiAgLmtleXMoe1xuICAgIHNlcnZpY2VOYW1lOiBKb2kuc3RyaW5nKClcbiAgICAgIC5yZXF1aXJlZCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJUaGUgbmFtZSBvZiB0aGUgc2VydmljZSB0aGUgbG9nIGVudHJ5IG9yaWdpbmF0ZWQgZnJvbS5cIiksXG4gICAgdGltZXN0YW1wOiBKb2kuZGF0ZSgpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIHRpbWUgd2hlbiB0aGUgbG9nIGVudHJ5IHdhcyBnZW5lcmF0ZWQgYnkgdGhlIHNlcnZpY2UuXCIpLFxuICAgIG1zZzogSm9pLnN0cmluZygpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIGNvbnRlbnQgb2YgdGhlIGxvZyBlbnRyeS5cIiksXG4gIH0pXG4gIC5kZXNjcmlwdGlvbihcIkEgbG9nIGVudHJ5IHJldHVybmVkIGJ5IGEgZ2V0U2VydmljZUxvZ3MgYWN0aW9uIGhhbmRsZXIuXCIpXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0U2VydmljZUxvZ3NSZXN1bHQgeyB9XG5cbmV4cG9ydCBjb25zdCBnZXRTZXJ2aWNlTG9nc1Jlc3VsdFNjaGVtYSA9IEpvaS5vYmplY3QoKS5rZXlzKHt9KVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZHVsZVR5cGVEZXNjcmlwdGlvbiB7XG4gIGRvY3M6IHN0cmluZ1xuICBzY2hlbWE6IG9iamVjdFxufVxuXG5leHBvcnQgY29uc3QgbW9kdWxlVHlwZURlc2NyaXB0aW9uU2NoZW1hID0gSm9pLm9iamVjdCgpXG4gIC5rZXlzKHtcbiAgICBkb2NzOiBKb2kuc3RyaW5nKClcbiAgICAgIC5yZXF1aXJlZCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJEb2N1bWVudGF0aW9uIGZvciB0aGUgbW9kdWxlIHR5cGUsIGluIG1hcmtkb3duIGZvcm1hdC5cIiksXG4gICAgc2NoZW1hOiBKb2kub2JqZWN0KClcbiAgICAgIC5yZXF1aXJlZCgpXG4gICAgICAuZGVzY3JpcHRpb24oXG4gICAgICAgIFwiQSB2YWxpZCBPcGVuQVBJIHNjaGVtYSBkZXNjcmliaW5nIHRoZSBjb25maWd1cmF0aW9uIGtleXMgZm9yIHRoZSBgbW9kdWxlYCBmaWVsZCBpbiB0aGUgbW9kdWxlJ3MgYGdhcmRlbi55bWxgLlwiLFxuICAgICAgKSxcbiAgfSlcblxuZXhwb3J0IHR5cGUgVmFsaWRhdGVNb2R1bGVSZXN1bHQ8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gPVxuICBNb2R1bGVDb25maWc8VFtcInNwZWNcIl0sIFRbXCJzZXJ2aWNlQ29uZmlnc1wiXVswXVtcInNwZWNcIl0sIFRbXCJ0ZXN0Q29uZmlnc1wiXVswXVtcInNwZWNcIl0+XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZU1vZHVsZVJlc3VsdFNjaGVtYSA9IG1vZHVsZUNvbmZpZ1NjaGVtYVxuXG5leHBvcnQgaW50ZXJmYWNlIEJ1aWxkUmVzdWx0IHtcbiAgYnVpbGRMb2c/OiBzdHJpbmdcbiAgZmV0Y2hlZD86IGJvb2xlYW5cbiAgZnJlc2g/OiBib29sZWFuXG4gIHZlcnNpb24/OiBzdHJpbmdcbiAgZGV0YWlscz86IGFueVxufVxuZXhwb3J0IGNvbnN0IGJ1aWxkTW9kdWxlUmVzdWx0U2NoZW1hID0gSm9pLm9iamVjdCgpXG4gIC5rZXlzKHtcbiAgICBidWlsZExvZzogSm9pLnN0cmluZygpXG4gICAgICAuYWxsb3coXCJcIilcbiAgICAgIC5kZXNjcmlwdGlvbihcIlRoZSBmdWxsIGxvZyBmcm9tIHRoZSBidWlsZC5cIiksXG4gICAgZmV0Y2hlZDogSm9pLmJvb2xlYW4oKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiU2V0IHRvIHRydWUgaWYgdGhlIGJ1aWxkIHdhcyBmZXRjaGVkIGZyb20gYSByZW1vdGUgcmVnaXN0cnkuXCIpLFxuICAgIGZyZXNoOiBKb2kuYm9vbGVhbigpXG4gICAgICAuZGVzY3JpcHRpb24oXCJTZXQgdG8gdHJ1ZSBpZiB0aGUgYnVpbGQgd2FzIHBlcmZvbWVkLCBmYWxzZSBpZiBpdCB3YXMgYWxyZWFkeSBidWlsdCwgb3IgZmV0Y2hlZCBmcm9tIGEgcmVnaXN0cnlcIiksXG4gICAgdmVyc2lvbjogSm9pLnN0cmluZygpXG4gICAgICAuZGVzY3JpcHRpb24oXCJUaGUgdmVyc2lvbiB0aGF0IHdhcyBidWlsdC5cIiksXG4gICAgZGV0YWlsczogSm9pLm9iamVjdCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJBZGRpdGlvbmFsIGluZm9ybWF0aW9uLCBzcGVjaWZpYyB0byB0aGUgcHJvdmlkZXIuXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIFB1c2hSZXN1bHQge1xuICBwdXNoZWQ6IGJvb2xlYW5cbiAgbWVzc2FnZT86IHN0cmluZ1xufVxuZXhwb3J0IGNvbnN0IHB1c2hNb2R1bGVSZXN1bHRTY2hlbWEgPSBKb2kub2JqZWN0KClcbiAgLmtleXMoe1xuICAgIHB1c2hlZDogSm9pLmJvb2xlYW4oKVxuICAgICAgLnJlcXVpcmVkKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIlNldCB0byB0cnVlIGlmIHRoZSBtb2R1bGUgd2FzIHB1c2hlZC5cIiksXG4gICAgbWVzc2FnZTogSm9pLnN0cmluZygpXG4gICAgICAuZGVzY3JpcHRpb24oXCJPcHRpb25hbCByZXN1bHQgbWVzc2FnZS5cIiksXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgUHVibGlzaFJlc3VsdCB7XG4gIHB1Ymxpc2hlZDogYm9vbGVhblxuICBtZXNzYWdlPzogc3RyaW5nXG59XG5leHBvcnQgY29uc3QgcHVibGlzaE1vZHVsZVJlc3VsdFNjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgcHVibGlzaGVkOiBKb2kuYm9vbGVhbigpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiU2V0IHRvIHRydWUgaWYgdGhlIG1vZHVsZSB3YXMgcHVibGlzaGVkLlwiKSxcbiAgICBtZXNzYWdlOiBKb2kuc3RyaW5nKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIk9wdGlvbmFsIHJlc3VsdCBtZXNzYWdlLlwiKSxcbiAgfSlcblxuZXhwb3J0IGludGVyZmFjZSBSdW5SZXN1bHQge1xuICBtb2R1bGVOYW1lOiBzdHJpbmdcbiAgY29tbWFuZDogc3RyaW5nW11cbiAgdmVyc2lvbjogTW9kdWxlVmVyc2lvblxuICBzdWNjZXNzOiBib29sZWFuXG4gIHN0YXJ0ZWRBdDogRGF0ZVxuICBjb21wbGV0ZWRBdDogRGF0ZVxuICBvdXRwdXQ6IHN0cmluZ1xufVxuXG5leHBvcnQgY29uc3QgcnVuUmVzdWx0U2NoZW1hID0gSm9pLm9iamVjdCgpXG4gIC5rZXlzKHtcbiAgICBtb2R1bGVOYW1lOiBKb2kuc3RyaW5nKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIlRoZSBuYW1lIG9mIHRoZSBtb2R1bGUgdGhhdCB3YXMgcnVuLlwiKSxcbiAgICBjb21tYW5kOiBKb2kuYXJyYXkoKS5pdGVtcyhKb2kuc3RyaW5nKCkpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIGNvbW1hbmQgdGhhdCB3YXMgcnVuIGluIHRoZSBtb2R1bGUuXCIpLFxuICAgIHZlcnNpb246IG1vZHVsZVZlcnNpb25TY2hlbWEsXG4gICAgc3VjY2VzczogSm9pLmJvb2xlYW4oKVxuICAgICAgLnJlcXVpcmVkKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIldoZXRoZXIgdGhlIG1vZHVsZSB3YXMgc3VjY2Vzc2Z1bGx5IHJ1bi5cIiksXG4gICAgc3RhcnRlZEF0OiBKb2kuZGF0ZSgpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiV2hlbiB0aGUgbW9kdWxlIHJ1biB3YXMgc3RhcnRlZC5cIiksXG4gICAgY29tcGxldGVkQXQ6IEpvaS5kYXRlKClcbiAgICAgIC5yZXF1aXJlZCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJXaGVuIHRoZSBtb2R1bGUgcnVuIHdhcyBjb21wbGV0ZWQuXCIpLFxuICAgIG91dHB1dDogSm9pLnN0cmluZygpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmFsbG93KFwiXCIpXG4gICAgICAuZGVzY3JpcHRpb24oXCJUaGUgb3V0cHV0IGxvZyBmcm9tIHRoZSBydW4uXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIFRlc3RSZXN1bHQgZXh0ZW5kcyBSdW5SZXN1bHQge1xuICB0ZXN0TmFtZTogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCB0ZXN0UmVzdWx0U2NoZW1hID0gcnVuUmVzdWx0U2NoZW1hXG4gIC5rZXlzKHtcbiAgICB0ZXN0TmFtZTogSm9pLnN0cmluZygpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIG5hbWUgb2YgdGhlIHRlc3QgdGhhdCB3YXMgcnVuLlwiKSxcbiAgfSlcblxuZXhwb3J0IGNvbnN0IGdldFRlc3RSZXN1bHRTY2hlbWEgPSB0ZXN0UmVzdWx0U2NoZW1hLmFsbG93KG51bGwpXG5cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRTdGF0dXMge1xuICByZWFkeTogYm9vbGVhblxufVxuXG5leHBvcnQgY29uc3QgYnVpbGRTdGF0dXNTY2hlbWEgPSBKb2kub2JqZWN0KClcbiAgLmtleXMoe1xuICAgIHJlYWR5OiBKb2kuYm9vbGVhbigpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiV2hldGhlciBhbiB1cC10by1kYXRlIGJ1aWxkIGlzIHJlYWR5IGZvciB0aGUgbW9kdWxlLlwiKSxcbiAgfSlcblxuZXhwb3J0IGludGVyZmFjZSBQbHVnaW5BY3Rpb25PdXRwdXRzIHtcbiAgZ2V0RW52aXJvbm1lbnRTdGF0dXM6IFByb21pc2U8RW52aXJvbm1lbnRTdGF0dXM+XG4gIHByZXBhcmVFbnZpcm9ubWVudDogUHJvbWlzZTxQcmVwYXJlRW52aXJvbm1lbnRSZXN1bHQ+XG4gIGNsZWFudXBFbnZpcm9ubWVudDogUHJvbWlzZTxDbGVhbnVwRW52aXJvbm1lbnRSZXN1bHQ+XG5cbiAgZ2V0U2VjcmV0OiBQcm9taXNlPEdldFNlY3JldFJlc3VsdD5cbiAgc2V0U2VjcmV0OiBQcm9taXNlPFNldFNlY3JldFJlc3VsdD5cbiAgZGVsZXRlU2VjcmV0OiBQcm9taXNlPERlbGV0ZVNlY3JldFJlc3VsdD5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJ2aWNlQWN0aW9uT3V0cHV0cyB7XG4gIGdldFNlcnZpY2VTdGF0dXM6IFByb21pc2U8U2VydmljZVN0YXR1cz5cbiAgZGVwbG95U2VydmljZTogUHJvbWlzZTxTZXJ2aWNlU3RhdHVzPlxuICBkZWxldGVTZXJ2aWNlOiBQcm9taXNlPFNlcnZpY2VTdGF0dXM+XG4gIGdldFNlcnZpY2VPdXRwdXRzOiBQcm9taXNlPFByaW1pdGl2ZU1hcD5cbiAgZXhlY0luU2VydmljZTogUHJvbWlzZTxFeGVjSW5TZXJ2aWNlUmVzdWx0PlxuICBnZXRTZXJ2aWNlTG9nczogUHJvbWlzZTx7fT5cbiAgcnVuU2VydmljZTogUHJvbWlzZTxSdW5SZXN1bHQ+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kdWxlQWN0aW9uT3V0cHV0cyBleHRlbmRzIFNlcnZpY2VBY3Rpb25PdXRwdXRzIHtcbiAgZGVzY3JpYmVUeXBlOiBQcm9taXNlPE1vZHVsZVR5cGVEZXNjcmlwdGlvbj5cbiAgdmFsaWRhdGU6IFByb21pc2U8VmFsaWRhdGVNb2R1bGVSZXN1bHQ+XG4gIGdldEJ1aWxkU3RhdHVzOiBQcm9taXNlPEJ1aWxkU3RhdHVzPlxuICBidWlsZDogUHJvbWlzZTxCdWlsZFJlc3VsdD5cbiAgcHVzaE1vZHVsZTogUHJvbWlzZTxQdXNoUmVzdWx0PlxuICBwdWJsaXNoTW9kdWxlOiBQcm9taXNlPFB1Ymxpc2hSZXN1bHQ+XG4gIHJ1bk1vZHVsZTogUHJvbWlzZTxSdW5SZXN1bHQ+XG4gIHRlc3RNb2R1bGU6IFByb21pc2U8VGVzdFJlc3VsdD5cbiAgZ2V0VGVzdFJlc3VsdDogUHJvbWlzZTxUZXN0UmVzdWx0IHwgbnVsbD5cbn1cbiJdfQ==
