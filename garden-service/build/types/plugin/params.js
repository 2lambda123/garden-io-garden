"use strict";
/*
 * Copyright (C) 2018 Garden Technologies, Inc. <info@garden.io>
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const plugin_context_1 = require("../../plugin-context");
const base_1 = require("../../vcs/base");
const common_1 = require("../../config/common");
const module_1 = require("../module");
const service_1 = require("../service");
const outputs_1 = require("./outputs");
const Joi = require("joi");
const module_2 = require("../../config/module");
const test_1 = require("../../config/test");
// Note: not specifying this further because we will later remove it from the API
const logEntrySchema = Joi.object()
    .description("Logging context handler that the handler can use to log messages and progress.");
const actionParamsSchema = Joi.object()
    .keys({
    ctx: plugin_context_1.pluginContextSchema
        .required(),
    logEntry: logEntrySchema,
});
const moduleActionParamsSchema = actionParamsSchema
    .keys({
    module: module_1.moduleSchema,
});
const serviceActionParamsSchema = moduleActionParamsSchema
    .keys({
    runtimeContext: service_1.runtimeContextSchema
        .optional(),
    service: service_1.serviceSchema,
});
exports.describeModuleTypeParamsSchema = Joi.object()
    .keys({});
exports.validateModuleParamsSchema = Joi.object()
    .keys({
    ctx: plugin_context_1.pluginContextSchema
        .required(),
    logEntry: logEntrySchema,
    moduleConfig: module_2.moduleConfigSchema
        .required(),
});
exports.getEnvironmentStatusParamsSchema = actionParamsSchema;
exports.prepareEnvironmentParamsSchema = actionParamsSchema
    .keys({
    status: outputs_1.environmentStatusSchema,
    force: Joi.boolean()
        .description("Force re-configuration of the environment."),
});
exports.cleanupEnvironmentParamsSchema = actionParamsSchema;
exports.getSecretParamsSchema = actionParamsSchema
    .keys({
    key: Joi.string()
        .description("A unique identifier for the secret."),
});
exports.setSecretParamsSchema = exports.getSecretParamsSchema
    .keys({
    value: common_1.joiPrimitive()
        .description("The value of the secret."),
});
exports.deleteSecretParamsSchema = exports.getSecretParamsSchema;
exports.getBuildStatusParamsSchema = moduleActionParamsSchema;
exports.buildModuleParamsSchema = moduleActionParamsSchema;
exports.pushModuleParamsSchema = moduleActionParamsSchema;
exports.publishModuleParamsSchema = moduleActionParamsSchema;
const runBaseParams = {
    interactive: Joi.boolean()
        .description("Whether to run the module interactively (i.e. attach to the terminal)."),
    runtimeContext: service_1.runtimeContextSchema,
    silent: Joi.boolean()
        .description("Set to false if the output should not be logged to the console."),
    timeout: Joi.number()
        .optional()
        .description("If set, how long to run the command before timing out."),
};
const runModuleBaseSchema = moduleActionParamsSchema
    .keys(runBaseParams);
exports.runModuleParamsSchema = runModuleBaseSchema
    .keys({
    command: common_1.joiArray(Joi.string())
        .description("The command to run in the module."),
});
exports.testModuleParamsSchema = runModuleBaseSchema
    .keys({
    testConfig: test_1.testConfigSchema,
});
exports.getTestResultParamsSchema = moduleActionParamsSchema
    .keys({
    testName: Joi.string()
        .description("A unique name to identify the test run."),
    version: base_1.moduleVersionSchema,
});
exports.getServiceStatusParamsSchema = serviceActionParamsSchema
    .keys({
    runtimeContext: service_1.runtimeContextSchema,
});
exports.deployServiceParamsSchema = serviceActionParamsSchema
    .keys({
    force: Joi.boolean()
        .description("Whether to force a re-deploy, even if the service is already deployed."),
    runtimeContext: service_1.runtimeContextSchema,
});
exports.deleteServiceParamsSchema = serviceActionParamsSchema
    .keys({
    runtimeContext: service_1.runtimeContextSchema,
});
exports.getServiceOutputsParamsSchema = serviceActionParamsSchema;
exports.execInServiceParamsSchema = serviceActionParamsSchema
    .keys({
    command: common_1.joiArray(Joi.string())
        .description("The command to run alongside the service."),
    runtimeContext: service_1.runtimeContextSchema,
});
exports.getServiceLogsParamsSchema = serviceActionParamsSchema
    .keys({
    runtimeContext: service_1.runtimeContextSchema,
    stream: Joi.object()
        .description("A Stream object, to write the logs to."),
    tail: Joi.boolean()
        .description("Whether to keep listening for logs until aborted."),
    startTime: Joi.date()
        .optional()
        .description("If set, only return logs that are as new or newer than this date."),
});
exports.runServiceParamsSchema = serviceActionParamsSchema
    .keys(runBaseParams);

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFBO0FBUVMsUUFBQSwwQkFBMEIsR0FBRyx5QkFBeUI7S0FDaEUsSUFBSSxDQUFDO0lBQ0osY0FBYyxFQUFFLDhCQUFvQjtJQUNwQyxNQUFNLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRTtTQUNqQixXQUFXLENBQUMsd0NBQXdDLENBQUM7SUFDeEQsSUFBSSxFQUFFLEdBQUcsQ0FBQyxPQUFPLEVBQUU7U0FDaEIsV0FBVyxDQUFDLG1EQUFtRCxDQUFDO0lBQ25FLFNBQVMsRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFO1NBQ2xCLFFBQVEsRUFBRTtTQUNWLFdBQVcsQ0FBQyxtRUFBbUUsQ0FBQztDQUNwRixDQUFDLENBQUE7QUFRUyxRQUFBLHNCQUFzQixHQUFHLHlCQUF5QjtLQUM1RCxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUEiLCJmaWxlIjoidHlwZXMvcGx1Z2luL3BhcmFtcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTggR2FyZGVuIFRlY2hub2xvZ2llcywgSW5jLiA8aW5mb0BnYXJkZW4uaW8+XG4gKlxuICogVGhpcyBTb3VyY2UgQ29kZSBGb3JtIGlzIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNb3ppbGxhIFB1YmxpY1xuICogTGljZW5zZSwgdi4gMi4wLiBJZiBhIGNvcHkgb2YgdGhlIE1QTCB3YXMgbm90IGRpc3RyaWJ1dGVkIHdpdGggdGhpc1xuICogZmlsZSwgWW91IGNhbiBvYnRhaW4gb25lIGF0IGh0dHA6Ly9tb3ppbGxhLm9yZy9NUEwvMi4wLy5cbiAqL1xuXG5pbXBvcnQgU3RyZWFtIGZyb20gXCJ0cy1zdHJlYW1cIlxuaW1wb3J0IHsgTG9nRW50cnkgfSBmcm9tIFwiLi4vLi4vbG9nZ2VyL2xvZy1lbnRyeVwiXG5pbXBvcnQgeyBQbHVnaW5Db250ZXh0LCBwbHVnaW5Db250ZXh0U2NoZW1hIH0gZnJvbSBcIi4uLy4uL3BsdWdpbi1jb250ZXh0XCJcbmltcG9ydCB7IE1vZHVsZVZlcnNpb24sIG1vZHVsZVZlcnNpb25TY2hlbWEgfSBmcm9tIFwiLi4vLi4vdmNzL2Jhc2VcIlxuaW1wb3J0IHsgUHJpbWl0aXZlLCBqb2lQcmltaXRpdmUsIGpvaUFycmF5IH0gZnJvbSBcIi4uLy4uL2NvbmZpZy9jb21tb25cIlxuaW1wb3J0IHsgTW9kdWxlLCBtb2R1bGVTY2hlbWEgfSBmcm9tIFwiLi4vbW9kdWxlXCJcbmltcG9ydCB7IFJ1bnRpbWVDb250ZXh0LCBTZXJ2aWNlLCBzZXJ2aWNlU2NoZW1hLCBydW50aW1lQ29udGV4dFNjaGVtYSB9IGZyb20gXCIuLi9zZXJ2aWNlXCJcbmltcG9ydCB7IEVudmlyb25tZW50U3RhdHVzLCBTZXJ2aWNlTG9nRW50cnksIGVudmlyb25tZW50U3RhdHVzU2NoZW1hIH0gZnJvbSBcIi4vb3V0cHV0c1wiXG5pbXBvcnQgKiBhcyBKb2kgZnJvbSBcImpvaVwiXG5pbXBvcnQgeyBtb2R1bGVDb25maWdTY2hlbWEgfSBmcm9tIFwiLi4vLi4vY29uZmlnL21vZHVsZVwiXG5pbXBvcnQgeyB0ZXN0Q29uZmlnU2NoZW1hIH0gZnJvbSBcIi4uLy4uL2NvbmZpZy90ZXN0XCJcblxuZXhwb3J0IGludGVyZmFjZSBQbHVnaW5BY3Rpb25Db250ZXh0UGFyYW1zIHtcbiAgY3R4OiBQbHVnaW5Db250ZXh0XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGx1Z2luQWN0aW9uUGFyYW1zQmFzZSBleHRlbmRzIFBsdWdpbkFjdGlvbkNvbnRleHRQYXJhbXMge1xuICBsb2dFbnRyeT86IExvZ0VudHJ5XG59XG5cbi8vIE5vdGU6IG5vdCBzcGVjaWZ5aW5nIHRoaXMgZnVydGhlciBiZWNhdXNlIHdlIHdpbGwgbGF0ZXIgcmVtb3ZlIGl0IGZyb20gdGhlIEFQSVxuY29uc3QgbG9nRW50cnlTY2hlbWEgPSBKb2kub2JqZWN0KClcbiAgLmRlc2NyaXB0aW9uKFwiTG9nZ2luZyBjb250ZXh0IGhhbmRsZXIgdGhhdCB0aGUgaGFuZGxlciBjYW4gdXNlIHRvIGxvZyBtZXNzYWdlcyBhbmQgcHJvZ3Jlc3MuXCIpXG5cbmNvbnN0IGFjdGlvblBhcmFtc1NjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgY3R4OiBwbHVnaW5Db250ZXh0U2NoZW1hXG4gICAgICAucmVxdWlyZWQoKSxcbiAgICBsb2dFbnRyeTogbG9nRW50cnlTY2hlbWEsXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgUGx1Z2luTW9kdWxlQWN0aW9uUGFyYW1zQmFzZTxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbkFjdGlvblBhcmFtc0Jhc2Uge1xuICBtb2R1bGU6IFRcbn1cbmNvbnN0IG1vZHVsZUFjdGlvblBhcmFtc1NjaGVtYSA9IGFjdGlvblBhcmFtc1NjaGVtYVxuICAua2V5cyh7XG4gICAgbW9kdWxlOiBtb2R1bGVTY2hlbWEsXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgUGx1Z2luU2VydmljZUFjdGlvblBhcmFtc0Jhc2U8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gZXh0ZW5kcyBQbHVnaW5Nb2R1bGVBY3Rpb25QYXJhbXNCYXNlPFQ+IHtcbiAgcnVudGltZUNvbnRleHQ/OiBSdW50aW1lQ29udGV4dFxuICBzZXJ2aWNlOiBTZXJ2aWNlPFQ+XG59XG5jb25zdCBzZXJ2aWNlQWN0aW9uUGFyYW1zU2NoZW1hID0gbW9kdWxlQWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICBydW50aW1lQ29udGV4dDogcnVudGltZUNvbnRleHRTY2hlbWFcbiAgICAgIC5vcHRpb25hbCgpLFxuICAgIHNlcnZpY2U6IHNlcnZpY2VTY2hlbWEsXG4gIH0pXG5cbi8qKlxuICogUGx1Z2luIGFjdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEZXNjcmliZU1vZHVsZVR5cGVQYXJhbXMgeyB9XG5leHBvcnQgY29uc3QgZGVzY3JpYmVNb2R1bGVUeXBlUGFyYW1zU2NoZW1hID0gSm9pLm9iamVjdCgpXG4gIC5rZXlzKHt9KVxuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRlTW9kdWxlUGFyYW1zPFQgZXh0ZW5kcyBNb2R1bGUgPSBNb2R1bGU+IHtcbiAgY3R4OiBQbHVnaW5Db250ZXh0XG4gIGxvZ0VudHJ5PzogTG9nRW50cnlcbiAgbW9kdWxlQ29uZmlnOiBUW1wiX0NvbmZpZ1R5cGVcIl1cbn1cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZU1vZHVsZVBhcmFtc1NjaGVtYSA9IEpvaS5vYmplY3QoKVxuICAua2V5cyh7XG4gICAgY3R4OiBwbHVnaW5Db250ZXh0U2NoZW1hXG4gICAgICAucmVxdWlyZWQoKSxcbiAgICBsb2dFbnRyeTogbG9nRW50cnlTY2hlbWEsXG4gICAgbW9kdWxlQ29uZmlnOiBtb2R1bGVDb25maWdTY2hlbWFcbiAgICAgIC5yZXF1aXJlZCgpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldEVudmlyb25tZW50U3RhdHVzUGFyYW1zIGV4dGVuZHMgUGx1Z2luQWN0aW9uUGFyYW1zQmFzZSB7IH1cbmV4cG9ydCBjb25zdCBnZXRFbnZpcm9ubWVudFN0YXR1c1BhcmFtc1NjaGVtYSA9IGFjdGlvblBhcmFtc1NjaGVtYVxuXG5leHBvcnQgaW50ZXJmYWNlIFByZXBhcmVFbnZpcm9ubWVudFBhcmFtcyBleHRlbmRzIFBsdWdpbkFjdGlvblBhcmFtc0Jhc2Uge1xuICBzdGF0dXM6IEVudmlyb25tZW50U3RhdHVzXG4gIGZvcmNlOiBib29sZWFuXG59XG5leHBvcnQgY29uc3QgcHJlcGFyZUVudmlyb25tZW50UGFyYW1zU2NoZW1hID0gYWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICBzdGF0dXM6IGVudmlyb25tZW50U3RhdHVzU2NoZW1hLFxuICAgIGZvcmNlOiBKb2kuYm9vbGVhbigpXG4gICAgICAuZGVzY3JpcHRpb24oXCJGb3JjZSByZS1jb25maWd1cmF0aW9uIG9mIHRoZSBlbnZpcm9ubWVudC5cIiksXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xlYW51cEVudmlyb25tZW50UGFyYW1zIGV4dGVuZHMgUGx1Z2luQWN0aW9uUGFyYW1zQmFzZSB7XG59XG5leHBvcnQgY29uc3QgY2xlYW51cEVudmlyb25tZW50UGFyYW1zU2NoZW1hID0gYWN0aW9uUGFyYW1zU2NoZW1hXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0U2VjcmV0UGFyYW1zIGV4dGVuZHMgUGx1Z2luQWN0aW9uUGFyYW1zQmFzZSB7XG4gIGtleTogc3RyaW5nXG59XG5leHBvcnQgY29uc3QgZ2V0U2VjcmV0UGFyYW1zU2NoZW1hID0gYWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICBrZXk6IEpvaS5zdHJpbmcoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiQSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNlY3JldC5cIiksXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2V0U2VjcmV0UGFyYW1zIGV4dGVuZHMgUGx1Z2luQWN0aW9uUGFyYW1zQmFzZSB7XG4gIGtleTogc3RyaW5nXG4gIHZhbHVlOiBQcmltaXRpdmVcbn1cbmV4cG9ydCBjb25zdCBzZXRTZWNyZXRQYXJhbXNTY2hlbWEgPSBnZXRTZWNyZXRQYXJhbXNTY2hlbWFcbiAgLmtleXMoe1xuICAgIHZhbHVlOiBqb2lQcmltaXRpdmUoKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiVGhlIHZhbHVlIG9mIHRoZSBzZWNyZXQuXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIERlbGV0ZVNlY3JldFBhcmFtcyBleHRlbmRzIFBsdWdpbkFjdGlvblBhcmFtc0Jhc2Uge1xuICBrZXk6IHN0cmluZ1xufVxuZXhwb3J0IGNvbnN0IGRlbGV0ZVNlY3JldFBhcmFtc1NjaGVtYSA9IGdldFNlY3JldFBhcmFtc1NjaGVtYVxuXG5leHBvcnQgaW50ZXJmYWNlIFBsdWdpbkFjdGlvblBhcmFtcyB7XG4gIGdldEVudmlyb25tZW50U3RhdHVzOiBHZXRFbnZpcm9ubWVudFN0YXR1c1BhcmFtc1xuICBwcmVwYXJlRW52aXJvbm1lbnQ6IFByZXBhcmVFbnZpcm9ubWVudFBhcmFtc1xuICBjbGVhbnVwRW52aXJvbm1lbnQ6IENsZWFudXBFbnZpcm9ubWVudFBhcmFtc1xuXG4gIGdldFNlY3JldDogR2V0U2VjcmV0UGFyYW1zXG4gIHNldFNlY3JldDogU2V0U2VjcmV0UGFyYW1zXG4gIGRlbGV0ZVNlY3JldDogRGVsZXRlU2VjcmV0UGFyYW1zXG59XG5cbi8qKlxuICogTW9kdWxlIGFjdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZXRCdWlsZFN0YXR1c1BhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbk1vZHVsZUFjdGlvblBhcmFtc0Jhc2U8VD4geyB9XG5leHBvcnQgY29uc3QgZ2V0QnVpbGRTdGF0dXNQYXJhbXNTY2hlbWEgPSBtb2R1bGVBY3Rpb25QYXJhbXNTY2hlbWFcblxuZXhwb3J0IGludGVyZmFjZSBCdWlsZE1vZHVsZVBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbk1vZHVsZUFjdGlvblBhcmFtc0Jhc2U8VD4geyB9XG5leHBvcnQgY29uc3QgYnVpbGRNb2R1bGVQYXJhbXNTY2hlbWEgPSBtb2R1bGVBY3Rpb25QYXJhbXNTY2hlbWFcblxuZXhwb3J0IGludGVyZmFjZSBQdXNoTW9kdWxlUGFyYW1zPFQgZXh0ZW5kcyBNb2R1bGUgPSBNb2R1bGU+IGV4dGVuZHMgUGx1Z2luTW9kdWxlQWN0aW9uUGFyYW1zQmFzZTxUPiB7IH1cbmV4cG9ydCBjb25zdCBwdXNoTW9kdWxlUGFyYW1zU2NoZW1hID0gbW9kdWxlQWN0aW9uUGFyYW1zU2NoZW1hXG5cbmV4cG9ydCBpbnRlcmZhY2UgUHVibGlzaE1vZHVsZVBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbk1vZHVsZUFjdGlvblBhcmFtc0Jhc2U8VD4geyB9XG5leHBvcnQgY29uc3QgcHVibGlzaE1vZHVsZVBhcmFtc1NjaGVtYSA9IG1vZHVsZUFjdGlvblBhcmFtc1NjaGVtYVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1bk1vZHVsZVBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbk1vZHVsZUFjdGlvblBhcmFtc0Jhc2U8VD4ge1xuICBjb21tYW5kOiBzdHJpbmdbXVxuICBpbnRlcmFjdGl2ZTogYm9vbGVhblxuICBydW50aW1lQ29udGV4dDogUnVudGltZUNvbnRleHRcbiAgc2lsZW50OiBib29sZWFuXG4gIHRpbWVvdXQ/OiBudW1iZXJcbn1cbmNvbnN0IHJ1bkJhc2VQYXJhbXMgPSB7XG4gIGludGVyYWN0aXZlOiBKb2kuYm9vbGVhbigpXG4gICAgLmRlc2NyaXB0aW9uKFwiV2hldGhlciB0byBydW4gdGhlIG1vZHVsZSBpbnRlcmFjdGl2ZWx5IChpLmUuIGF0dGFjaCB0byB0aGUgdGVybWluYWwpLlwiKSxcbiAgcnVudGltZUNvbnRleHQ6IHJ1bnRpbWVDb250ZXh0U2NoZW1hLFxuICBzaWxlbnQ6IEpvaS5ib29sZWFuKClcbiAgICAuZGVzY3JpcHRpb24oXCJTZXQgdG8gZmFsc2UgaWYgdGhlIG91dHB1dCBzaG91bGQgbm90IGJlIGxvZ2dlZCB0byB0aGUgY29uc29sZS5cIiksXG4gIHRpbWVvdXQ6IEpvaS5udW1iZXIoKVxuICAgIC5vcHRpb25hbCgpXG4gICAgLmRlc2NyaXB0aW9uKFwiSWYgc2V0LCBob3cgbG9uZyB0byBydW4gdGhlIGNvbW1hbmQgYmVmb3JlIHRpbWluZyBvdXQuXCIpLFxufVxuY29uc3QgcnVuTW9kdWxlQmFzZVNjaGVtYSA9IG1vZHVsZUFjdGlvblBhcmFtc1NjaGVtYVxuICAua2V5cyhydW5CYXNlUGFyYW1zKVxuZXhwb3J0IGNvbnN0IHJ1bk1vZHVsZVBhcmFtc1NjaGVtYSA9IHJ1bk1vZHVsZUJhc2VTY2hlbWFcbiAgLmtleXMoe1xuICAgIGNvbW1hbmQ6IGpvaUFycmF5KEpvaS5zdHJpbmcoKSlcbiAgICAgIC5kZXNjcmlwdGlvbihcIlRoZSBjb21tYW5kIHRvIHJ1biBpbiB0aGUgbW9kdWxlLlwiKSxcbiAgfSlcblxuZXhwb3J0IGludGVyZmFjZSBUZXN0TW9kdWxlUGFyYW1zPFQgZXh0ZW5kcyBNb2R1bGUgPSBNb2R1bGU+IGV4dGVuZHMgUGx1Z2luTW9kdWxlQWN0aW9uUGFyYW1zQmFzZTxUPiB7XG4gIGludGVyYWN0aXZlOiBib29sZWFuXG4gIHJ1bnRpbWVDb250ZXh0OiBSdW50aW1lQ29udGV4dFxuICBzaWxlbnQ6IGJvb2xlYW5cbiAgdGVzdENvbmZpZzogVFtcInRlc3RDb25maWdzXCJdWzBdXG59XG5leHBvcnQgY29uc3QgdGVzdE1vZHVsZVBhcmFtc1NjaGVtYSA9IHJ1bk1vZHVsZUJhc2VTY2hlbWFcbiAgLmtleXMoe1xuICAgIHRlc3RDb25maWc6IHRlc3RDb25maWdTY2hlbWEsXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0VGVzdFJlc3VsdFBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpbk1vZHVsZUFjdGlvblBhcmFtc0Jhc2U8VD4ge1xuICB0ZXN0TmFtZTogc3RyaW5nXG4gIHZlcnNpb246IE1vZHVsZVZlcnNpb25cbn1cbmV4cG9ydCBjb25zdCBnZXRUZXN0UmVzdWx0UGFyYW1zU2NoZW1hID0gbW9kdWxlQWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICB0ZXN0TmFtZTogSm9pLnN0cmluZygpXG4gICAgICAuZGVzY3JpcHRpb24oXCJBIHVuaXF1ZSBuYW1lIHRvIGlkZW50aWZ5IHRoZSB0ZXN0IHJ1bi5cIiksXG4gICAgdmVyc2lvbjogbW9kdWxlVmVyc2lvblNjaGVtYSxcbiAgfSlcblxuLyoqXG4gKiBTZXJ2aWNlIGFjdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZXRTZXJ2aWNlU3RhdHVzUGFyYW1zPFQgZXh0ZW5kcyBNb2R1bGUgPSBNb2R1bGU+IGV4dGVuZHMgUGx1Z2luU2VydmljZUFjdGlvblBhcmFtc0Jhc2U8VD4ge1xuICBydW50aW1lQ29udGV4dDogUnVudGltZUNvbnRleHRcbn1cbmV4cG9ydCBjb25zdCBnZXRTZXJ2aWNlU3RhdHVzUGFyYW1zU2NoZW1hID0gc2VydmljZUFjdGlvblBhcmFtc1NjaGVtYVxuICAua2V5cyh7XG4gICAgcnVudGltZUNvbnRleHQ6IHJ1bnRpbWVDb250ZXh0U2NoZW1hLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIERlcGxveVNlcnZpY2VQYXJhbXM8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gZXh0ZW5kcyBQbHVnaW5TZXJ2aWNlQWN0aW9uUGFyYW1zQmFzZTxUPiB7XG4gIGZvcmNlOiBib29sZWFuXG4gIHJ1bnRpbWVDb250ZXh0OiBSdW50aW1lQ29udGV4dFxufVxuZXhwb3J0IGNvbnN0IGRlcGxveVNlcnZpY2VQYXJhbXNTY2hlbWEgPSBzZXJ2aWNlQWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICBmb3JjZTogSm9pLmJvb2xlYW4oKVxuICAgICAgLmRlc2NyaXB0aW9uKFwiV2hldGhlciB0byBmb3JjZSBhIHJlLWRlcGxveSwgZXZlbiBpZiB0aGUgc2VydmljZSBpcyBhbHJlYWR5IGRlcGxveWVkLlwiKSxcbiAgICBydW50aW1lQ29udGV4dDogcnVudGltZUNvbnRleHRTY2hlbWEsXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVsZXRlU2VydmljZVBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpblNlcnZpY2VBY3Rpb25QYXJhbXNCYXNlPFQ+IHtcbiAgcnVudGltZUNvbnRleHQ6IFJ1bnRpbWVDb250ZXh0XG59XG5leHBvcnQgY29uc3QgZGVsZXRlU2VydmljZVBhcmFtc1NjaGVtYSA9IHNlcnZpY2VBY3Rpb25QYXJhbXNTY2hlbWFcbiAgLmtleXMoe1xuICAgIHJ1bnRpbWVDb250ZXh0OiBydW50aW1lQ29udGV4dFNjaGVtYSxcbiAgfSlcblxuZXhwb3J0IGludGVyZmFjZSBHZXRTZXJ2aWNlT3V0cHV0c1BhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiBleHRlbmRzIFBsdWdpblNlcnZpY2VBY3Rpb25QYXJhbXNCYXNlPFQ+IHsgfVxuZXhwb3J0IGNvbnN0IGdldFNlcnZpY2VPdXRwdXRzUGFyYW1zU2NoZW1hID0gc2VydmljZUFjdGlvblBhcmFtc1NjaGVtYVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4ZWNJblNlcnZpY2VQYXJhbXM8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gZXh0ZW5kcyBQbHVnaW5TZXJ2aWNlQWN0aW9uUGFyYW1zQmFzZTxUPiB7XG4gIGNvbW1hbmQ6IHN0cmluZ1tdXG4gIHJ1bnRpbWVDb250ZXh0OiBSdW50aW1lQ29udGV4dFxufVxuZXhwb3J0IGNvbnN0IGV4ZWNJblNlcnZpY2VQYXJhbXNTY2hlbWEgPSBzZXJ2aWNlQWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHtcbiAgICBjb21tYW5kOiBqb2lBcnJheShKb2kuc3RyaW5nKCkpXG4gICAgICAuZGVzY3JpcHRpb24oXCJUaGUgY29tbWFuZCB0byBydW4gYWxvbmdzaWRlIHRoZSBzZXJ2aWNlLlwiKSxcbiAgICBydW50aW1lQ29udGV4dDogcnVudGltZUNvbnRleHRTY2hlbWEsXG4gIH0pXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0U2VydmljZUxvZ3NQYXJhbXM8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gZXh0ZW5kcyBQbHVnaW5TZXJ2aWNlQWN0aW9uUGFyYW1zQmFzZTxUPiB7XG4gIHJ1bnRpbWVDb250ZXh0OiBSdW50aW1lQ29udGV4dFxuICBzdHJlYW06IFN0cmVhbTxTZXJ2aWNlTG9nRW50cnk+XG4gIHRhaWw6IGJvb2xlYW5cbiAgc3RhcnRUaW1lPzogRGF0ZVxufVxuZXhwb3J0IGNvbnN0IGdldFNlcnZpY2VMb2dzUGFyYW1zU2NoZW1hID0gc2VydmljZUFjdGlvblBhcmFtc1NjaGVtYVxuICAua2V5cyh7XG4gICAgcnVudGltZUNvbnRleHQ6IHJ1bnRpbWVDb250ZXh0U2NoZW1hLFxuICAgIHN0cmVhbTogSm9pLm9iamVjdCgpXG4gICAgICAuZGVzY3JpcHRpb24oXCJBIFN0cmVhbSBvYmplY3QsIHRvIHdyaXRlIHRoZSBsb2dzIHRvLlwiKSxcbiAgICB0YWlsOiBKb2kuYm9vbGVhbigpXG4gICAgICAuZGVzY3JpcHRpb24oXCJXaGV0aGVyIHRvIGtlZXAgbGlzdGVuaW5nIGZvciBsb2dzIHVudGlsIGFib3J0ZWQuXCIpLFxuICAgIHN0YXJ0VGltZTogSm9pLmRhdGUoKVxuICAgICAgLm9wdGlvbmFsKClcbiAgICAgIC5kZXNjcmlwdGlvbihcIklmIHNldCwgb25seSByZXR1cm4gbG9ncyB0aGF0IGFyZSBhcyBuZXcgb3IgbmV3ZXIgdGhhbiB0aGlzIGRhdGUuXCIpLFxuICB9KVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1blNlcnZpY2VQYXJhbXM8VCBleHRlbmRzIE1vZHVsZSA9IE1vZHVsZT4gZXh0ZW5kcyBQbHVnaW5TZXJ2aWNlQWN0aW9uUGFyYW1zQmFzZTxUPiB7XG4gIGludGVyYWN0aXZlOiBib29sZWFuXG4gIHJ1bnRpbWVDb250ZXh0OiBSdW50aW1lQ29udGV4dFxuICBzaWxlbnQ6IGJvb2xlYW5cbiAgdGltZW91dD86IG51bWJlclxufVxuZXhwb3J0IGNvbnN0IHJ1blNlcnZpY2VQYXJhbXNTY2hlbWEgPSBzZXJ2aWNlQWN0aW9uUGFyYW1zU2NoZW1hXG4gIC5rZXlzKHJ1bkJhc2VQYXJhbXMpXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VydmljZUFjdGlvblBhcmFtczxUIGV4dGVuZHMgTW9kdWxlID0gTW9kdWxlPiB7XG4gIGdldFNlcnZpY2VTdGF0dXM6IEdldFNlcnZpY2VTdGF0dXNQYXJhbXM8VD5cbiAgZGVwbG95U2VydmljZTogRGVwbG95U2VydmljZVBhcmFtczxUPlxuICBkZWxldGVTZXJ2aWNlOiBEZWxldGVTZXJ2aWNlUGFyYW1zPFQ+XG4gIGdldFNlcnZpY2VPdXRwdXRzOiBHZXRTZXJ2aWNlT3V0cHV0c1BhcmFtczxUPlxuICBleGVjSW5TZXJ2aWNlOiBFeGVjSW5TZXJ2aWNlUGFyYW1zPFQ+XG4gIGdldFNlcnZpY2VMb2dzOiBHZXRTZXJ2aWNlTG9nc1BhcmFtczxUPlxuICBydW5TZXJ2aWNlOiBSdW5TZXJ2aWNlUGFyYW1zPFQ+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kdWxlQWN0aW9uUGFyYW1zPFQgZXh0ZW5kcyBNb2R1bGUgPSBNb2R1bGU+IHtcbiAgZGVzY3JpYmVUeXBlOiBEZXNjcmliZU1vZHVsZVR5cGVQYXJhbXMsXG4gIHZhbGlkYXRlOiBWYWxpZGF0ZU1vZHVsZVBhcmFtczxUPlxuICBnZXRCdWlsZFN0YXR1czogR2V0QnVpbGRTdGF0dXNQYXJhbXM8VD5cbiAgYnVpbGQ6IEJ1aWxkTW9kdWxlUGFyYW1zPFQ+XG4gIHB1c2hNb2R1bGU6IFB1c2hNb2R1bGVQYXJhbXM8VD5cbiAgcHVibGlzaE1vZHVsZTogUHVibGlzaE1vZHVsZVBhcmFtczxUPlxuICBydW5Nb2R1bGU6IFJ1bk1vZHVsZVBhcmFtczxUPlxuICB0ZXN0TW9kdWxlOiBUZXN0TW9kdWxlUGFyYW1zPFQ+XG4gIGdldFRlc3RSZXN1bHQ6IEdldFRlc3RSZXN1bHRQYXJhbXM8VD5cbn1cbiJdfQ==
